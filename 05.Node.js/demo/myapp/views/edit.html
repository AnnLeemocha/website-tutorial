<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyLyrics | 編輯歌詞</title>
    <link rel="shortcut icon" href="/A.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link rel="stylesheet" href="/style.css" />
</head>

<body>
    <header>
        <nav>
            <div class="logo">
                <a href="/">
                    <img src="/A.png" alt="MyLyrics"> MyLyrics
                </a>
            </div>
            <div class="menu">
                <a href="/manage">歌單管理</a>
                <a href="/about">關於</a>
            </div>
        </nav>
        <div class="backhome" class="p-4">
            <a href="/">&lt; 回首頁</a>
        </div>
    </header>

    <main class="container modify">
        <h1 class="title">新增歌詞</h1>
        <form id="editSongForm">
            <label>歌名：
                <input id="title" type="text" name="title" required>
            </label>

            <label>歌手：
                <input id="artist" type="text" name="artist" required>
            </label>

            <label>專輯圖片：
                <!-- <div style="display: flex; align-items: center; gap: 8px;">
                    <img id="image" style="height: 6rem; width: 6rem;" src="" alt="專輯圖片">
                </div> -->
                <input type="file" name="image" accept="image/*" />
            </label>

            <label>歌詞內容：
                <textarea id="lyrics" name="lyrics" rows="10" required></textarea>
            </label>

            <button type="submit">提交歌詞</button>
        </form>

        <p id="message" style="color: red; margin-top: 10px;"></p>

    </main>

    <footer>
        <div class="footer-content">
            <div>&copy; 2025 MyLyrics. 版權所有.</div>
            <div>
                <a href="/">首頁</a> |
                <a href="/about">關於我們</a>
            </div>
        </div>
    </footer>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const songId = urlParams.get('id');

        const form = document.getElementById('editSongForm');

        const song = {
            "id": "f05ae3f0-abab-4986-acb1-f47875204754",
            "title": "Golden",
            "artist": "HUNTR/X, EJAE, AUDREY NUNA, REI AMI, KPop Demon Hunters Cast",
            "image": "/uploads/KPOP DEMON HUNTERS.jpg",
            "lyrics": "I was a ghost, I was alone, hah\n어두워진, hah, 압길속에 (Ah)\nGiven the throne, I didn't know how to believe\nI was the queen that I'm meant to be\nI lived two lives, tried to play both sides\nBut I couldn't find my own place\nCalled a problem child 'cause I got too wild\nBut now that's how I'm getting paid, 끝없이 on stage\n\nI'm done hidin', now I'm shinin' like I'm born to be\nWe dreamin' hard, we came so far, now I believe\n\nWe're goin' up, up, up, it's our moment\nYou know together we're glowing\nGonna be, gonna be golden\nOh, up, up, up with our voices\n영원히 깨질 수 없는\nGonna be, gonna be golden\n\nOh, I'm done hidin' now I'm shinin' like I'm born to be\nOh, our time, no fear, no lies\nThat's who we're born to be\n\nWaited so long to break these walls down\nTo wake up and feel like me\nPut these patterns all in the past now\nAnd finally live like the girl they all see\n\nNo more hiding, I'll be shining like I'm born to be\n'Cause we are hunters, voices strong, and I know I believe\n\nWe're goin' up, up, up, it's our moment\nYou know together we're glowing\nGonna be, gonna be golden\nOh, up, up, up, with our voices\n영원히 깨질 수 없는\nGonna be, gonna be golden\n\nOh, I'm done hidin', now I'm shining like I'm born to be\nOh, our time, no fears, no lies\nThat's who we're born to be\n\nYou know we're gonna be, gonna be golden\nWe're gonna be, gonna be\nBorn to be, born to be glowin'\n밝게 빛나는 우린\nYou know that it's our time, no fears, no lies\nThat's who we're born to be"
        };
        console.log("發送取得 API (假)");
        console.log(song);
        document.querySelector('input[name="title"]').value = song.title;
        document.querySelector('input[name="artist"]').value = song["artist"];
        // document.querySelector('input[name="image"]').value = song.image;
        document.querySelector('textarea[name="lyrics"]').value = song.lyrics;


        // API 取得資料
        // fetch(`/api/songs/${songId}`)
        //     .then(res => {
        //         if (!res.ok) throw new Error('找不到歌曲');
        //         return res.json();
        //     })
        //     .then(song => {
        //         console.log(song);

        //         document.getElementById('title').value = song.title;
        //         document.getElementById('artist').value = song.artist;
        //         // document.getElementById('image').src = song.image;
        //         // document.getElementById('image').alt = song.title;
        //         document.getElementById('lyrics').value = song.lyrics;
        //     })
        //     .catch(err => {
        //         alert('找不到這首歌');
        //         window.location.href = '/manage';
        //     });

        // 送出更新
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            const updatedData = {
                title: form.title.value.trim(),
                artist: form.artist.value.trim(),
                lyrics: form.lyrics.value.replace(/\r\n/g, '\n')
            };

            console.log("送出更新 API (假)");

            // API 送出更新
            // fetch(`/api/songs/${songId}`, {
            //     method: 'PUT',
            //     headers: {
            //         'Content-Type': 'application/json'
            //     },
            //     body: JSON.stringify(updatedData)
            // })
            //     .then(res => {
            //         if (res.ok) {
            //             alert('更新成功！');
            //             window.location.href = '/manage';
            //         } else {
            //             alert('更新失敗');
            //         }
            //     })
            //     .catch(err => {
            //         console.error(err);
            //         alert('更新時發生錯誤');
            //     });
        });
    </script>
</body>

</html>